<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Comparateur Rule34 (SFW - GitHub Pages)</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; text-align: center; padding: 40px; }
    input { padding: 8px; margin: 5px; border: none; border-radius: 5px; width: 150px; text-align: center; }
    button { padding: 8px 16px; margin: 10px; cursor: pointer; background: #444; color: white; border: none; border-radius: 5px; transition: background 0.2s; }
    button:hover { background: #666; }
    .result { font-size: 1.2em; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Comparateur de tags (Rule34.xxx - SFW)</h1>

  <div>
    <input id="tag1" placeholder="Tag 1" value="hololive">
    <input id="tag2" placeholder="Tag 2" value="vtuber">
  </div>

  <button id="compareBtn">Comparer</button>

  <div class="result" id="result"></div>

  <script>
    async function getCount(tag) {
      const url = `https://api.rule34.xxx/index.php?page=dapi&s=tag&q=index&name=${encodeURIComponent(tag)}&json=1`;
      const response = await fetch(url);
      if (!response.ok) throw new Error("Erreur API");
      const data = await response.json();
      if (Array.isArray(data) && data.length > 0) return parseInt(data[0].count);
      return 0;
    }

    async function compareTags() {
      const tag1 = document.getElementById("tag1").value.trim().replace(/^#/, "");
      const tag2 = document.getElementById("tag2").value.trim().replace(/^#/, "");
      const resultDiv = document.getElementById("result");

      if (!tag1 || !tag2) {
        resultDiv.textContent = "Veuillez entrer deux tags √† comparer.";
        return;
      }

      resultDiv.textContent = "Comparaison en cours...";

      try {
        const [count1, count2] = await Promise.all([getCount(tag1), getCount(tag2)]);

        let text = `R√©sultats : #${tag1} = ${count1} | #${tag2} = ${count2}`;
        if (count1 > count2) text += ` üèÜ ${tag1} gagne !`;
        else if (count2 > count1) text += ` üèÜ ${tag2} gagne !`;
        else text += ` ‚öñÔ∏è √âgalit√© parfaite !`;

        resultDiv.textContent = text;
      } catch (err) {
        resultDiv.textContent = "Erreur lors de la r√©cup√©ration des donn√©es (CORS).\nH√©bergez ce fichier sur GitHub Pages pour que √ßa fonctionne.";
        console.error(err);
      }
    }

    document.getElementById("compareBtn").addEventListener("click", compareTags);
  </script>
</body>
</html>
